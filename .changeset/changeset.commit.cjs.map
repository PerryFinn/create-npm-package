{"version":3,"sources":["../scripts/changeset.commit.ts"],"sourcesContent":["/**\n * Changesets 提交消息自定义配置\n *\n * 该文件用于定义 Changesets 在添加变更集和发布版本时生成的提交消息格式，主要功能包括：\n * 1. 规范提交消息格式，符合约定式提交规范（Conventional Commits）\n * 2. 自动生成包含包版本信息的发布日志\n * 3. 支持通过 skipCI 配置跳过 CI 执行\n *\n * 导出的 defaultCommitFunctions 包含两个核心方法：\n * - getAddMessage: 生成添加 changeset 的提交信息，格式为 docs(changeset): <summary>\n * - getVersionMessage: 生成版本发布提交信息，包含发布的包列表和版本号\n *\n * 使用 [skip ci] 标记来适配 GitHub Actions 等 CI 系统的跳过机制\n */\nimport type { Changeset, CommitFunctions, ReleasePlan } from \"@changesets/types\";\n\ntype SkipCI = boolean | \"add\" | \"version\";\n\nconst getAddMessage: CommitFunctions[\"getAddMessage\"] = async (\n  changeset: Changeset,\n  options: { skipCI?: SkipCI } | null\n) => {\n  const skipCI = options?.skipCI === \"add\" || options?.skipCI === true;\n  const skipMsg = skipCI ? \"\\n\\n[skip ci]\\n\" : \"\";\n  return `docs(changeset): ${changeset.summary}${skipMsg}`;\n};\n\nconst getVersionMessage: CommitFunctions[\"getVersionMessage\"] = async (\n  releasePlan: ReleasePlan,\n  options: { skipCI?: SkipCI } | null\n) => {\n  const skipCI = options?.skipCI === \"version\" || options?.skipCI === true;\n  const publishableReleases = releasePlan.releases.filter((release) => release.type !== \"none\");\n  const numPackagesReleased = publishableReleases.length;\n\n  if (publishableReleases.length === 1) {\n    const release = publishableReleases[0];\n    if (!release) {\n      throw new Error(\"release info is undefined\");\n    }\n    return `chore(release): ${release.name}@${release.newVersion}`;\n  }\n\n  const releasesLines = publishableReleases.map((release) => `  ${release.name}@${release.newVersion}`).join(\"\\n\");\n\n  return `chore(release): releasing ${numPackagesReleased} package(s)\n\nReleases:\n${releasesLines}\n${skipCI ? \"\\n[skip ci]\\n\" : \"\"}`;\n};\n\nconst defaultCommitFunctions: Required<CommitFunctions> = {\n  getAddMessage,\n  getVersionMessage\n};\n\nexport default defaultCommitFunctions;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAkBA,IAAM,gBAAkD,OACtD,WACA,YACG;AACH,QAAM,SAAS,SAAS,WAAW,SAAS,SAAS,WAAW;AAChE,QAAM,UAAU,SAAS,oBAAoB;AAC7C,SAAO,oBAAoB,UAAU,OAAO,GAAG,OAAO;AACxD;AAEA,IAAM,oBAA0D,OAC9D,aACA,YACG;AACH,QAAM,SAAS,SAAS,WAAW,aAAa,SAAS,WAAW;AACpE,QAAM,sBAAsB,YAAY,SAAS,OAAO,CAAC,YAAY,QAAQ,SAAS,MAAM;AAC5F,QAAM,sBAAsB,oBAAoB;AAEhD,MAAI,oBAAoB,WAAW,GAAG;AACpC,UAAM,UAAU,oBAAoB,CAAC;AACrC,QAAI,CAAC,SAAS;AACZ,YAAM,IAAI,MAAM,2BAA2B;AAAA,IAC7C;AACA,WAAO,mBAAmB,QAAQ,IAAI,IAAI,QAAQ,UAAU;AAAA,EAC9D;AAEA,QAAM,gBAAgB,oBAAoB,IAAI,CAAC,YAAY,KAAK,QAAQ,IAAI,IAAI,QAAQ,UAAU,EAAE,EAAE,KAAK,IAAI;AAE/G,SAAO,6BAA6B,mBAAmB;AAAA;AAAA;AAAA,EAGvD,aAAa;AAAA,EACb,SAAS,kBAAkB,EAAE;AAC/B;AAEA,IAAM,yBAAoD;AAAA,EACxD;AAAA,EACA;AACF;AAEA,IAAO,2BAAQ;","names":[]}